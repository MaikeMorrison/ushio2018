---
title: "Replication of Figure 2: Time-varying interspecific interactions in a subset of the Maizuru fish community"
author:
  - Chih-Fu Yeh:
      email: yehcf@stanford.edu
      institute: Stanford University
      correspondence: true
  - Maike Morrison:
      email: maikem@stanford.edu
      institute: Stanford University
      correspondence: false
  - Shirley SerranoRojas:
      email: serranoj@stanford.edu
      institute: Stanford University
      correspondence: false
institute:
  - Stanford University: Ecology and Evolution, Department of Biology, Stanford University, USA

date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
abstract: |
  Ecological theory suggests that large-scale patterns such as community stability can be influenced by changes in interspecific interactions that arise from the behavioural and/or physiological responses of individual species varying over time. Although this theory has experimental support, evidence from natural ecosystems is lacking. Here, using tools for analysing nonlinear time series and a 12-year-long dataset of fortnightly collected observations on a natural marine fish community in Maizuru Bay, Japan, the show that short-term changes in interaction networks influence overall community dynamics. Figure 2 shows that interactions in the Maizuru Bay fish community are not static; this contradicts a common assumption of ecological research. Instead, they change over time, as expected for a system with nonlinear dynamics. Of the 14 interspecific interactions, on average 8 are negative and 6 are positive. ...
  
  
  
keywords: |
  Interaction networks; seasonal patterns; keyword 3
highlights: |
  These are the highlights. 
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- With the following code you can access and display values from the yml header above. -->

Keywords: `r rmarkdown::metadata$keywords`

Highlights: `r rmarkdown::metadata$highlights`

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)

library(ushio2018)
library(plotly)
library(reticulate)
library(tidyverse)
library(pforeach)

```

<!-- The actual document text starts here: -->

# Introduction



Here is a citation [@Marwick2017]


# Methods

Long-term time-series data of the fish community were obtained by underwater direct visual census conducted approximately once every two weeks along the coast of the Maizuru Fishery Research Station of Kyoto University (Nagahama, Maizuru: 35° 28′ N, 135° 22′ E) from 1 January 2002 to 2 April 2014 (285 time points during approximately 12 years). This high-frequency census enables the detection of short-term interspecific interactions.

## Reproducibility

The data and code used in this analysis were packaged as a research compendium (R package `rrtools`) [@marwickPackagingDataAnalytical2018; @rrtools2019]. The research compendium was written as an R package so other researchers can read, run, and modify the methods described here.


# Results

<!-- Here's some example analysis code: -->

```{r }
# Note the path that we need to use to access our data files when rendering this document
biw.data <- read.csv(here::here("analysis/data/raw_data/Maizuru_dominant_sp.csv"))
d_bestE0 <- read.csv(here::here("analysis/data/raw_data/Maizuru_ccm_res.csv"))
```

## Extract causality and interactions

```{r }
num.for.smapc <- extract_causality (d_bestE0)
d.name   <- names(biw.data)[4:18]
new.nums<- arrange_interactions(num.for.smapc)
smapc.res <- SmapCFunc(new.nums, smapc.tp = 1, stats.output = T,
                       embedding = "best_E", original.data = biw.data)
smapc.tp1 <- smapc.res$coefs
interaction_extract <- int_extract(smapc.tp1)
plot_obj <- plot_time_3d(interaction_extract )
save_image(plot_obj , file = "analysis/figures/image.png", width= 1200, height = 800,scale  =3)
```

Figure \@ref(fig:demo-plot) shows how we can have a caption and cross-reference for a plot

```{r demo-inline-code}
x <- round(pi, 2)
```

Here is an example of inline code `r x` in the middle of a sentence. 

# Discussion

# Conclusion

# Acknowledgements

<!-- The following line inserts a page break  -->

\newpage

# References 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
